{% extends "base.html" %}

{% block content %}
<div class="row mb-4">
    <div class="col-md-12">
        <h1>PhD Application Dashboard</h1>
    </div>
</div>

<!-- Stats Cards -->
<div class="row mb-4">
    <div class="col-md-2">
        <div class="card bg-primary text-white">
            <div class="card-body">
                <h5>Total</h5>
                <h3>{{ stats.total }}</h3>
            </div>
        </div>
    </div>
    <div class="col-md-2">
        <div class="card bg-info text-white">
            <div class="card-body">
                <h5>Contacted</h5>
                <h3>{{ stats.contacted }}</h3>
            </div>
        </div>
    </div>
    <div class="col-md-2">
        <div class="card bg-success text-white">
            <div class="card-body">
                <h5>Responses</h5>
                <h3>{{ stats.responses }}</h3>
            </div>
        </div>
    </div>
    <div class="col-md-2">
        <div class="card bg-warning text-dark">
            <div class="card-body">
                <h5>Interviews</h5>
                <h3>{{ stats.interviews }}</h3>
            </div>
        </div>
    </div>
    <div class="col-md-2">
        <div class="card bg-success text-white">
            <div class="card-body">
                <h5>Accepted</h5>
                <h3>{{ stats.accepted }}</h3>
            </div>
        </div>
    </div>
</div>

<!-- Chart -->
<div class="row mb-4">
    <div class="col-md-12">
        <div class="card">
            <div class="card-header">
                <h5>Weekly Progress</h5>
            </div>
            <div class="card-body">
                <canvas id="progressChart" width="400" height="100"></canvas>
            </div>
        </div>
    </div>
</div>

<!-- Filter Controls -->
<div class="row mb-3">
    <div class="col-md-4">
        <select class="form-control" id="universityFilter">
            <option value="">All Universities</option>
            {% for university in universities %}
            <option value="{{ university }}">{{ university }}</option>
            {% endfor %}
        </select>
    </div>
    <div class="col-md-4">
        <select class="form-control" id="researchAreaFilter">
            <option value="">All Research Areas</option>
            {% for area in research_areas %}
            <option value="{{ area }}">{{ area }}</option>
            {% endfor %}
        </select>
    </div>
    <div class="col-md-4">
        <select class="form-control" id="statusFilter">
            <option value="">All Statuses</option>
            <option value="Not Contacted">Not Contacted</option>
            <option value="Contacted">Contacted</option>
            <option value="Response">Response</option>
            <option value="Interview">Interview</option>
            <option value="Accepted">Accepted</option>
            <option value="Rejected">Rejected</option>
        </select>
    </div>
</div>

<!-- Professor List -->
<div class="row">
    <div class="col-md-12">
        <div class="card">
            <div class="card-header d-flex justify-content-between align-items-center">
                <h5>Professor List</h5>
                <a href="{{ url_for('add_professor') }}" class="btn btn-primary">Add Professor</a>
            </div>
            <div class="card-body">
                <table class="table table-striped" id="professorTable">
                    <thead>
                        <tr>
                            <th>Name</th>
                            <th>University</th>
                            <th>Department</th>
                            <th>Research Area</th>
                            <th>Status</th>
                            <th>Contact Date</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for prof in professors %}
                        <tr data-university="{{ prof.university }}" data-research-area="{{ prof.research_area or '' }}" data-status="{{ prof.status }}">
                            <td>{{ prof.name }}</td>
                            <td>{{ prof.university }}</td>
                            <td>{{ prof.department }}</td>
                            <td>{{ prof.research_area or '-' }}</td>
                            <td>
                                <span class="badge 
                                    {% if prof.status == 'Not Contacted' %}bg-secondary
                                    {% elif prof.status == 'Contacted' %}bg-info
                                    {% elif prof.status == 'Response' %}bg-success
                                    {% elif prof.status == 'Interview' %}bg-warning text-dark
                                    {% elif prof.status == 'Accepted' %}bg-success
                                    {% elif prof.status == 'Rejected' %}bg-danger
                                    {% endif %}">
                                    {{ prof.status }}
                                </span>
                            </td>
                            <td>{{ prof.contact_date.strftime('%Y-%m-%d') if prof.contact_date else '-' }}</td>
                            <td>
                                <a href="{{ url_for('edit_professor', id=prof.id) }}" class="btn btn-sm btn-outline-primary">Edit</a>
                                <a href="{{ url_for('delete_professor', id=prof.id) }}" class="btn btn-sm btn-outline-danger" onclick="return confirm('Are you sure?')">Delete</a>
                            </td>
                        </tr>
                        {% endfor %}
                    </tbody>
                </table>
            </div>
        </div>
    </div>
</div>
{% endblock %}